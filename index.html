<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Викторина "Угадай растение"</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
                'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
                sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        const PlantQuizGame = () => {
            // Данные растений с локализацией
            const plantsDatabase = [
                { 
                    id: 1, 
                    image: "images/BeachDaisy.JPG",
                    names: {
                        ru: "Пляжная маргаритка",
                        en: "Beach Daisy",
                        sci: "Arctotheca calendula"
                    }
                },
                { 
                    id: 2, 
                    image: "images/MoonCarrot.JPG",
                    names: {
                        ru: "Лунная морковь",
                        en: "Moon Carrot",
                        sci: "Seseli tortuosum"
                    }
                },
                { 
                    id: 3, 
                    image: "images/Agapanthus.JPG",
                    names: {
                        ru: "Агапантус",
                        en: "Agapanthus",
                        sci: "Agapanthus africanus"
                    }
                },
                { 
                    id: 4, 
                    image: "images/bougainvillea.JPG",
                    names: {
                        ru: "Бугенвиллия",
                        en: "Bougainvillea",
                        sci: "Bougainvillea spectabilis"
                    }
                },
                { 
                    id: 5, 
                    image: "images/camelia.JPG",
                    names: {
                        ru: "Камелия",
                        en: "Camellia",
                        sci: "Camellia japonica"
                    }
                },
                { 
                    id: 6, 
                    image: "images/Gerbera.JPG",
                    names: {
                        ru: "Гербера",
                        en: "Gerbera",
                        sci: "Gerbera jamesonii"
                    }
                }
            ];

            // Дополнительные неправильные варианты с локализацией
            const wrongAnswersDatabase = [
                { ru: "Роза", en: "Rose", sci: "Rosa spp." },
                { ru: "Тюльпан", en: "Tulip", sci: "Tulipa spp." },
                { ru: "Орхидея", en: "Orchid", sci: "Orchidaceae" },
                { ru: "Лилия", en: "Lily", sci: "Lilium spp." },
                { ru: "Пион", en: "Peony", sci: "Paeonia spp." },
                { ru: "Гортензия", en: "Hydrangea", sci: "Hydrangea macrophylla" },
                { ru: "Фиалка", en: "Violet", sci: "Viola spp." },
                { ru: "Хризантема", en: "Chrysanthemum", sci: "Chrysanthemum morifolium" },
                { ru: "Ирис", en: "Iris", sci: "Iris germanica" },
                { ru: "Нарцисс", en: "Daffodil", sci: "Narcissus spp." },
                { ru: "Лаванда", en: "Lavender", sci: "Lavandula angustifolia" },
                { ru: "Жасмин", en: "Jasmine", sci: "Jasminum officinale" },
                { ru: "Гибискус", en: "Hibiscus", sci: "Hibiscus rosa-sinensis" },
                { ru: "Магнолия", en: "Magnolia", sci: "Magnolia grandiflora" },
                { ru: "Азалия", en: "Azalea", sci: "Rhododendron spp." }
            ];

            // Тексты интерфейса с локализацией
            const uiTexts = {
                ru: {
                    question: "Что это за растение?",
                    score: "Баллы",
                    correct: "Верно!",
                    incorrect: "Неверно!",
                    result: "Вы получили",
                    resultPoints: "баллов",
                    playAgain: "Играть снова",
                    instruction: "Выберите правильное название растения"
                },
                en: {
                    question: "What plant is this?",
                    score: "Score",
                    correct: "Correct!",
                    incorrect: "Incorrect!",
                    result: "You scored",
                    resultPoints: "points",
                    playAgain: "Play Again",
                    instruction: "Choose the correct plant name"
                },
                sci: {
                    question: "Quae planta est?",
                    score: "Score",
                    correct: "Recte!",
                    incorrect: "Perperam!",
                    result: "Score",
                    resultPoints: "points",
                    playAgain: "Ludere iterum",
                    instruction: "Choose the correct scientific name"
                }
            };

            // Состояния
            const [language, setLanguage] = useState('ru');
            const [plants, setPlants] = useState([]);
            const [currentQuestion, setCurrentQuestion] = useState(0);
            const [score, setScore] = useState(0);
            const [gameState, setGameState] = useState('playing');
            const [options, setOptions] = useState([]);
            const [correctAnswer, setCorrectAnswer] = useState('');

            // Функция перемешивания массива
            const shuffleArray = (array) => {
                const shuffled = [...array];
                for (let i = shuffled.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
                }
                return shuffled;
            };

            // Преобразование данных растений для текущего языка
            const getPlantsForLanguage = (lang) => {
                return plantsDatabase.map(plant => ({
                    id: plant.id,
                    image: plant.image,
                    name: plant.names[lang]
                }));
            };

            // Получение неправильных ответов для текущего языка
            const getWrongAnswersForLanguage = (lang) => {
                return wrongAnswersDatabase.map(answer => answer[lang]);
            };

            // Функция генерации вариантов ответов
            const generateOptions = (correctPlant, allPlants, lang) => {
                const correctName = correctPlant.name;
                const incorrectOptions = [];
                
                // Собираем названия других растений из викторины
                const otherPlantNames = allPlants
                    .filter(p => p.name !== correctName)
                    .map(p => p.name);
                
                // Добавляем названия из дополнительного списка
                const wrongAnswers = getWrongAnswersForLanguage(lang);
                const allWrongOptions = [...otherPlantNames, ...wrongAnswers]
                    .filter(name => name !== correctName);
                
                // Перемешиваем неправильные варианты
                const shuffledWrong = shuffleArray(allWrongOptions);
                
                // Берем 3 неправильных варианта
                while (incorrectOptions.length < 3 && shuffledWrong.length > 0) {
                    const option = shuffledWrong.shift();
                    if (!incorrectOptions.includes(option)) {
                        incorrectOptions.push(option);
                    }
                }
                
                // Смешиваем с правильным ответом
                const allOptions = [correctName, ...incorrectOptions];
                return shuffleArray(allOptions);
            };

            // Инициализация игры
            useEffect(() => {
                const plantsForLang = getPlantsForLanguage(language);
                const shuffled = shuffleArray(plantsForLang);
                setPlants(shuffled);
                setCurrentQuestion(0);
                setScore(0);
                setGameState('playing');
            }, [language]);

            // Обновление вопроса
            useEffect(() => {
                if (plants.length > 0 && currentQuestion < plants.length) {
                    const currentPlant = plants[currentQuestion];
                    const newOptions = generateOptions(currentPlant, plants, language);
                    setOptions(newOptions);
                    setCorrectAnswer(currentPlant.name);
                }
            }, [currentQuestion, plants, language]);

            // Обработка ответа
            const handleAnswer = (selectedAnswer) => {
                if (selectedAnswer === correctAnswer) {
                    setScore(score + 1);
                    setGameState('correct');
                } else {
                    setGameState('incorrect');
                }

                setTimeout(() => {
                    if (currentQuestion + 1 < plants.length) {
                        setCurrentQuestion(currentQuestion + 1);
                        setGameState('playing');
                    } else {
                        setGameState('finished');
                    }
                }, 1500);
            };

            // Перезапуск игры
            const restartGame = () => {
                const plantsForLang = getPlantsForLanguage(language);
                const shuffled = shuffleArray(plantsForLang);
                setPlants(shuffled);
                setCurrentQuestion(0);
                setScore(0);
                setGameState('playing');
            };

            // Изменение языка
            const changeLanguage = (newLang) => {
                setLanguage(newLang);
            };

            // Получение изображения растения
            const getPlantImage = (plant) => {
                if (plant.image.startsWith('images/')) {
                    return React.createElement('img', {
                        key: 'plant-image',
                        src: plant.image,
                        alt: `Растение ${plant.id}`,
                        className: 'w-full h-full object-cover',
                        style: { 
                            border: '6px solid #C29C27'
                        }
                    });
                } else {
                    // Для эмодзи
                    return React.createElement('div', {
                        key: 'plant-emoji',
                        className: 'w-full h-full flex items-center justify-center text-9xl',
                        style: { 
                            border: '6px solid #C29C27',
                            backgroundColor: 'white'
                        }
                    }, plant.image);
                }
            };

            const texts = uiTexts[language];

            // Экран завершения игры
            if (gameState === 'finished') {
                return React.createElement('div', {
                    className: 'min-h-screen flex items-center justify-center relative',
                    style: { backgroundColor: '#163B3A' }
                }, [
                    // Декоративные золотые полоски
                    React.createElement('div', { key: 'decor1', className: 'absolute top-4 left-4 w-20 h-1', style: { backgroundColor: '#C29C27' } }),
                    React.createElement('div', { key: 'decor2', className: 'absolute top-8 left-8 w-32 h-1', style: { backgroundColor: '#C29C27' } }),
                    React.createElement('div', { key: 'decor3', className: 'absolute bottom-4 right-4 w-20 h-1', style: { backgroundColor: '#C29C27' } }),
                    React.createElement('div', { key: 'decor4', className: 'absolute bottom-8 right-8 w-32 h-1', style: { backgroundColor: '#C29C27' } }),
                    
                    React.createElement('div', {
                        key: 'result',
                        className: 'p-8 shadow-lg text-center max-w-md mx-4',
                        style: { backgroundColor: '#163B3A', border: '6px solid #C29C27' }
                    }, [
                        React.createElement('h1', {
                            key: 'title',
                            className: 'text-4xl font-bold mb-6',
                            style: { color: '#C29C27' }
                        }, `${texts.result} ${score} ${texts.resultPoints}!`),
                        React.createElement('button', {
                            key: 'restart',
                            onClick: restartGame,
                            className: 'px-6 py-3 font-semibold text-white transition-colors hover:opacity-80',
                            style: { backgroundColor: '#163B3A', border: '4px solid #C29C27', color: '#C29C27' }
                        }, texts.playAgain)
                    ])
                ]);
            }

            // Основной экран игры
            return React.createElement('div', {
                className: 'min-h-screen p-4 relative flex items-center justify-center',
                style: { backgroundColor: '#163B3A' }
            }, [
                // Декоративные золотые полоски
                React.createElement('div', { key: 'decor1', className: 'absolute top-4 left-4 w-24 h-1', style: { backgroundColor: '#C29C27' } }),
                React.createElement('div', { key: 'decor2', className: 'absolute top-8 left-8 w-40 h-1', style: { backgroundColor: '#C29C27' } }),
                React.createElement('div', { key: 'decor3', className: 'absolute top-12 left-12 w-16 h-1', style: { backgroundColor: '#C29C27' } }),
                React.createElement('div', { key: 'decor4', className: 'absolute bottom-4 right-4 w-24 h-1', style: { backgroundColor: '#C29C27' } }),
                React.createElement('div', { key: 'decor5', className: 'absolute bottom-8 right-8 w-40 h-1', style: { backgroundColor: '#C29C27' } }),
                React.createElement('div', { key: 'decor6', className: 'absolute bottom-12 right-12 w-16 h-1', style: { backgroundColor: '#C29C27' } }),
                
                React.createElement('div', {
                    key: 'container',
                    className: 'w-full max-w-5xl mx-auto relative z-10'
                }, [
                    // Заголовок со счетчиками и языковыми кнопками
                    React.createElement('div', {
                        key: 'header',
                        className: 'flex justify-between items-center mb-6'
                    }, [
                        React.createElement('div', {
                            key: 'progress',
                            className: 'text-2xl font-bold',
                            style: { color: '#C29C27' }
                        }, `${currentQuestion + 1}/${plants.length}`),
                        React.createElement('div', {
                            key: 'right-section',
                            className: 'flex items-center gap-4'
                        }, [
                            React.createElement('div', {
                                key: 'score',
                                className: 'text-2xl font-bold',
                                style: { color: '#C29C27' }
                            }, `${texts.score}: ${score}`),
                            // Языковые кнопки
                            React.createElement('div', {
                                key: 'lang-buttons',
                                className: 'flex gap-2'
                            }, ['ru', 'en', 'sci'].map(lang => 
                                React.createElement('button', {
                                    key: lang,
                                    onClick: () => changeLanguage(lang),
                                    className: 'px-3 py-1 text-sm font-bold uppercase transition-all',
                                    style: {
                                        backgroundColor: language === lang ? '#C29C27' : 'transparent',
                                        color: language === lang ? '#163B3A' : '#C29C27',
                                        border: '2px solid #C29C27'
                                    }
                                }, lang === 'sci' ? 'Sci' : lang.toUpperCase())
                            ))
                        ])
                    ]),

                    // Основная область игры
                    React.createElement('div', {
                        key: 'game-area',
                        className: 'p-8 shadow-lg',
                        style: { backgroundColor: '#163B3A', border: '6px solid #C29C27' }
                    }, [
                        // Вопрос
                        React.createElement('h2', {
                            key: 'question',
                            className: 'text-3xl font-bold text-center mb-8',
                            style: { color: '#C29C27' }
                        }, texts.question),

                        // Область изображения (увеличенная)
                        React.createElement('div', {
                            key: 'image-area',
                            className: 'mb-8 flex justify-center',
                            style: { height: '450px' }
                        }, [
                            gameState === 'playing' && plants.length > 0 && currentQuestion < plants.length && 
                                React.createElement('div', {
                                    className: 'h-full',
                                    style: { width: '675px' }
                                }, getPlantImage(plants[currentQuestion])),
                            
                            gameState === 'correct' && React.createElement('div', {
                                className: 'h-full flex items-center justify-center text-6xl font-bold',
                                style: { width: '675px', color: '#C29C27', backgroundColor: '#163B3A', border: '6px solid #C29C27' }
                            }, texts.correct),
                            
                            gameState === 'incorrect' && React.createElement('div', {
                                className: 'h-full flex items-center justify-center text-6xl font-bold',
                                style: { width: '675px', color: '#C29C27', backgroundColor: '#163B3A', border: '6px solid #C29C27' }
                            }, texts.incorrect)
                        ]),

                        // Варианты ответов
                        gameState === 'playing' && React.createElement('div', {
                            key: 'options',
                            className: 'grid grid-cols-2 gap-4 max-w-3xl mx-auto'
                        }, options.map((option, index) => 
                            React.createElement('button', {
                                key: `option-${index}`,
                                onClick: () => handleAnswer(option),
                                className: 'py-4 px-6 font-semibold text-xl transition-all duration-200 hover:opacity-80 hover:scale-105',
                                style: { 
                                    backgroundColor: '#163B3A', 
                                    border: '4px solid #C29C27',
                                    color: '#C29C27',
                                    boxShadow: '0 4px 8px rgba(0,0,0,0.3)'
                                }
                            }, option)
                        ))
                    ]),

                    // Инструкция внизу
                    React.createElement('div', {
                        key: 'instruction',
                        className: 'text-center mt-6 opacity-75',
                        style: { color: '#C29C27' }
                    }, texts.instruction)
                ])
            ]);
        };

        // Рендер приложения
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(React.createElement(PlantQuizGame));
    </script>
</body>
</html>
