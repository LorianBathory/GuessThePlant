# Добавление данных о родах

После перехода на JSON-источники вся информация о родах и связанных видах редактируется через файлы в `src/data/json/`. Загрузчик [`src/game/dataLoader.js`](../src/game/dataLoader.js) автоматически объединяет эти данные и разворачивает их в игровые структуры (`speciesById`, `plants`, списки сложностей), поэтому никаких JS-модулей с ручными импортами больше не требуется.

## 1. Обновите `genus.json`
1. Откройте [`src/data/json/genus.json`](../src/data/json/genus.json).
2. Добавьте новую запись с полями:
   - `id` — числовой идентификатор рода (например, `500`).
   - `slug` — строковый ключ (используется для отладки и человеко-читаемых ссылок).
   - `wrongAnswers` — базовый массив неправильных ответов (опционально).
   - `entries` — объект, где ключами выступают идентификаторы таксонов (`500`, `'500_1'`, `'500_2'`, …), а значениями — данные конкретного уровня.
3. Для каждой записи внутри `entries` укажите `names` (локализация), а также при необходимости `images` и `wrongAnswers`. Структуры строковых идентификаторов повторяют иерархию (`500` → `'500_1'` → `'500_1_1'`), что помогает автоматически связать снимки из [`plantImages.json`](../src/data/json/plantImages.json).

`dataLoader` применяет наследование `wrongAnswers`: сначала учитываются значения конкретного вида, затем переопределения из `speciesCatalog`, и только после этого — базовый список из `wrongAnswers` самого рода.【F:src/game/dataLoader.js†L198-L286】 Это избавляет от необходимости дублировать массивы для верхнеуровневой записи (`500`).

## 2. Свяжите род с каталогом видов
1. Откройте [`src/data/json/speciesCatalog.json`](../src/data/json/speciesCatalog.json).
2. Добавьте (или обновите) запись с ключом `500` и укажите `genusId: 500`. В этой же записи можно перечислить `wrongAnswers`, `images` или другие поля, которые должны переопределить значения из `genus.json`.
3. Если род предоставляет собственные локализации или изображения только для отдельных видов, пропишите их в соответствующих дочерних записях `entries` внутри `genus.json`. `speciesCatalog` хранит лишь дополнительные переопределения и ссылки на род.

## 3. Локализации
- Если названия уже указаны в `entries` внутри `genus.json`, их не нужно дублировать в [`plantNames.json`](../src/data/json/plantNames.json) — загрузчик автоматически подставит значения из родового файла.
- Для полностью новых видов (без записей в роде) добавьте локализации напрямую в `plantNames.json`. Формат объекта совпадает с `plantNamesById` в игре (ключ `ru/en/nl/sci`).

## 4. Сложность вопросов
1. Откройте [`src/data/json/difficulties.json`](../src/data/json/difficulties.json).
2. Добавьте идентификатор рода (`500`) или конкретного вида (`"500_1"`) в нужный список сложности внутри `questionIdsByDifficulty.plant`.
3. Чтобы задать индивидуальную сложность для изображения, пропишите его ID (например, `'p500_1_1'`) в соответствующем списке `imageIdsByDifficulty`.

Загрузчик предоставляет вспомогательные функции `getDifficultyByQuestionId` и `getDifficultyByImageId`, поэтому новые значения будут автоматически учтены в классическом и бесконечном режимах после обновления JSON.【F:src/game/dataLoader.js†L498-L531】

## 5. Проверка изменений
1. Выполните `npm run lint`, чтобы убедиться в корректности кода.
2. Запустите `npm run validate:data`, проверяющий экспортированный бандл данных по схеме. Скрипт подтянет JSON, соберёт `plantData.json` и сообщит об ошибках структуры.
3. Поднимите локальный сервер (`npm run serve`) и убедитесь, что новые вопросы и роды отображаются корректно.
